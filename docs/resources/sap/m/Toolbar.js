/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BarInPageEnabler","./ToolbarLayoutData","./ToolbarSpacer","./library","sap/ui/core/Control","sap/ui/core/EnabledPropagator","sap/ui/events/KeyCodes","./ToolbarRenderer"],function(t,e,o,i,r,n,s,a){"use strict";var p=i.ToolbarDesign,l=i.ToolbarStyle;var u=r.extend("sap.m.Toolbar",{metadata:{interfaces:["sap.ui.core.Toolbar","sap.m.IBar"],library:"sap.m",properties:{width:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:null},active:{type:"boolean",group:"Behavior",defaultValue:false},enabled:{type:"boolean",group:"Behavior",defaultValue:true},height:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:""},design:{type:"sap.m.ToolbarDesign",group:"Appearance",defaultValue:p.Auto},style:{type:"sap.m.ToolbarStyle",group:"Appearance",defaultValue:l.Standard}},defaultAggregation:"content",aggregations:{content:{type:"sap.ui.core.Control",multiple:true,singularName:"content"}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{press:{parameters:{srcControl:{type:"sap.ui.core.Control"}}}},designtime:"sap/m/designtime/Toolbar.designtime"}});n.call(u.prototype);u.shrinkClass="sapMTBShrinkItem";u.isRelativeWidth=function(t){return/^([-+]?\d+%|auto|inherit|)$/i.test(t)};u.getOrigWidth=function(t){var e=sap.ui.getCore().byId(t);if(!e||!e.getWidth){return""}return e.getWidth()};u.checkShrinkable=function(t,i){if(t instanceof o){return this.isRelativeWidth(t.getWidth())}i=i||this.shrinkClass;t.removeStyleClass(i);var r=this.getOrigWidth(t.getId());if(!this.isRelativeWidth(r)){return}var n=t.getLayoutData();if(n instanceof e){return n.getShrinkable()&&t.addStyleClass(i)}if(r.indexOf("%")>0||t.getMetadata().isInstanceOf("sap.ui.core.IShrinkable")){return t.addStyleClass(i)}var s=t.getDomRef();if(s&&(s.firstChild||{}).nodeType==3){return t.addStyleClass(i)}};u.prototype.init=function(){this.data("sap-ui-fastnavgroup","true",true);this._oContentDelegate={onAfterRendering:this._onAfterContentRendering}};u.prototype._markFirstLastVisibleItems=function(t){var e=this.$(),o=e.find(t+":first")[0],i=e.find(t+":last")[0],r=o?o.id:"",n=i?i.id:"",s=sap.ui.getCore().byId(r),a=sap.ui.getCore().byId(n);this._markControlAsVisibleItem(s,"sapMBarFirstVisibleChild");this._markControlAsVisibleItem(a,"sapMBarLastVisibleChild");this._oFirstVisibleItem=s;this._oLastVisibleItem=a};u.prototype._markControlAsVisibleItem=function(t,e){if(t){t.addStyleClass(e)}};u.prototype.onBeforeRendering=function(){if(this._oFirstVisibleItem){this._oFirstVisibleItem.removeStyleClass("sapMBarFirstVisibleChild")}if(this._oLastVisibleItem){this._oLastVisibleItem.removeStyleClass("sapMBarLastVisibleChild")}};u.prototype.onAfterRendering=function(){this._checkContents();this._markFirstLastVisibleItems(".sapMBarChild:visible")};u.prototype.onLayoutDataChange=function(){this.rerender()};u.prototype.addContent=function(t){this.addAggregation("content",t);this._onContentInserted(t);return this};u.prototype.insertContent=function(t,e){this.insertAggregation("content",t,e);this._onContentInserted(t);return this};u.prototype.removeContent=function(t){t=this.removeAggregation("content",t);this._onContentRemoved(t);return t};u.prototype.removeAllContent=function(){var t=this.removeAllAggregation("content")||[];t.forEach(this._onContentRemoved,this);return t};u.prototype.ontap=function(t){if(this.getActive()&&!t.isMarked()){t.setMarked();this.firePress({srcControl:t.srcControl})}};u.prototype.onsapenter=function(t){if(this.getActive()&&t.srcControl===this&&!t.isMarked()){t.setMarked();this.firePress({srcControl:this})}};u.prototype.onsapspace=function(t){if(t.srcControl===this){t.preventDefault()}};u.prototype.onkeyup=function(t){if(t.which===s.SPACE){this.onsapenter(t)}};u.prototype.ontouchstart=function(t){this.getActive()&&t.setMarked()};u.prototype._checkContents=function(){this.getContent().forEach(function(t){u.checkShrinkable(t)})};u.prototype._onContentInserted=function(t){if(t){t.attachEvent("_change",this._onContentPropertyChanged,this);t.addEventDelegate(this._oContentDelegate,t)}};u.prototype._onContentRemoved=function(t){if(t){t.detachEvent("_change",this._onContentPropertyChanged,this);t.removeEventDelegate(this._oContentDelegate,t)}};u.prototype._onAfterContentRendering=function(){var t=this.getLayoutData();if(t instanceof e){t.applyProperties()}};u.prototype._onContentPropertyChanged=function(t){if(t.getParameter("name")!="width"){return}var e=t.getSource();var o=e.getWidth().indexOf("%")>0;e.toggleStyleClass(u.shrinkClass,o)};u.prototype._getAccessibilityRole=function(){var t=this._getRootAccessibilityRole();if(this.getActive()){t="button"}return t};u.prototype.setDesign=function(t,e){if(!e){return this.setProperty("design",t)}this._sAutoDesign=this.validateProperty("design",t);return this};u.prototype.getActiveDesign=function(){var t=this.getDesign();if(t!=p.Auto){return t}return this._sAutoDesign||t};u.prototype.getTitleControl=function(){var t=sap.ui.require("sap/m/Title");if(!t){return}var e=this.getContent();for(var o=0;o<e.length;o++){var i=e[o];if(i instanceof t&&i.getVisible()){return i}}};u.prototype.getTitleId=function(){var t=this.getTitleControl();return t?t.getId():""};u.prototype.isContextSensitive=t.prototype.isContextSensitive;u.prototype.setHTMLTag=t.prototype.setHTMLTag;u.prototype.getHTMLTag=t.prototype.getHTMLTag;u.prototype.applyTagAndContextClassFor=t.prototype.applyTagAndContextClassFor;u.prototype._applyContextClassFor=t.prototype._applyContextClassFor;u.prototype._applyTag=t.prototype._applyTag;u.prototype._getContextOptions=t.prototype._getContextOptions;u.prototype._setRootAccessibilityRole=t.prototype._setRootAccessibilityRole;u.prototype._getRootAccessibilityRole=t.prototype._getRootAccessibilityRole;u.prototype._setRootAriaLevel=t.prototype._setRootAriaLevel;u.prototype._getRootAriaLevel=t.prototype._getRootAriaLevel;return u});