/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/Device","./PanelRenderer","sap/m/Button"],function(e,t,a,o,n,i){"use strict";var r=e.PanelAccessibleRole;var s=e.BackgroundDesign;var l=e.ButtonType;var p=t.extend("sap.m.Panel",{metadata:{library:"sap.m",properties:{headerText:{type:"string",group:"Data",defaultValue:""},width:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"auto"},expandable:{type:"boolean",group:"Appearance",defaultValue:false},expanded:{type:"boolean",group:"Appearance",defaultValue:false},expandAnimation:{type:"boolean",group:"Behavior",defaultValue:true},backgroundDesign:{type:"sap.m.BackgroundDesign",group:"Appearance",defaultValue:s.Translucent},accessibleRole:{type:"sap.m.PanelAccessibleRole",group:"Accessibility",defaultValue:r.Form}},defaultAggregation:"content",aggregations:{content:{type:"sap.ui.core.Control",multiple:true,singularName:"content"},headerToolbar:{type:"sap.m.Toolbar",multiple:false},infoToolbar:{type:"sap.m.Toolbar",multiple:false}},events:{expand:{parameters:{expand:{type:"boolean"},triggeredByInteraction:{type:"boolean"}}}},dnd:{draggable:true,droppable:true},designtime:"sap/m/designtime/Panel.designtime"}});p.prototype.init=function(){this._bInteractiveExpand=false;this.data("sap-ui-fastnavgroup","true",true)};p.prototype.onThemeChanged=function(){this._setContentHeight()};p.prototype.setExpanded=function(e){if(e===this.getExpanded()){return this}this.setProperty("expanded",e,true);if(!this.getExpandable()){return this}this._toggleExpandCollapse();this._toggleButtonIcon(e);this.fireExpand({expand:e,triggeredByInteraction:this._bInteractiveExpand});this._bInteractiveExpand=false;return this};p.prototype.onBeforeRendering=function(){if(this.getExpandable()&&!this.oButtonCollapsed){this.oButtonCollapsed=this._createButton()}if(this.oButtonCollapsed){this._getButton().$().attr("aria-expanded",this.getExpanded())}if(o.browser.msie||o.browser.edge){this._updateButtonAriaLabelledBy()}if(sap.ui.getCore().getConfiguration().getAccessibility()){this.$().attr("role",this.getAccessibleRole().toLowerCase())}};p.prototype.onAfterRendering=function(){var e=this.$(),t,a=this.getDomRef("content");var o=this.getDomRef();if(o){o.style.width=this.getWidth();var n=this.getHeight();o.style.height=n;if(parseFloat(n)!=0){o.querySelector(".sapMPanelContent").style.height=n}}this._setContentHeight();if(this.getExpandable()){t=this.oButtonCollapsed.$();a&&t.attr("aria-controls",a.id);if(this.getExpanded()){t.attr("aria-expanded","true")}else{e.children(".sapMPanelExpandablePart").css("display","none");t.attr("aria-expanded","false")}}};p.prototype.exit=function(){if(this.oButtonCollapsed){this.oButtonCollapsed.destroy();this.oButtonCollapsed=null}};p.prototype._createButton=function(){var e=this,t=a.getIconURI("slim-arrow-right"),o=sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("PANEL_ICON"),n;n=new i(e.getId()+"-CollapsedImg",{icon:t,tooltip:o,type:l.Transparent,press:function(){e._bInteractiveExpand=true;e.setExpanded(!e.getExpanded())}});this.addDependent(n);return n};p.prototype._getButton=function(){return this.oButtonCollapsed};p.prototype._toggleButtonIcon=function(e){var t=this._getButton(),o=e?a.getIconURI("slim-arrow-down"):a.getIconURI("slim-arrow-right");t&&t.setIcon(o)};p.prototype._setContentHeight=function(){var e,t=this.getDomRef(),a=t&&t.querySelector(".sapMPanelContent");if(this.getHeight()==="auto"||!a){return}e="calc("+this.getHeight()+" - "+a.offsetTop+"px)";a.style.height=e};p.prototype._toggleExpandCollapse=function(){var e={};if(!this.getExpandAnimation()){e.duration=0}this.$().children(".sapMPanelExpandablePart").slideToggle(e)};p.prototype._updateButtonAriaLabelledBy=function(){var e,t,a;if(!this.oButtonCollapsed){return}if(this.getAccessibleRole()===r.Form){a=true}e=this._getLabellingElementId();t=this.oButtonCollapsed.getAriaLabelledBy();if(e&&t.indexOf(e)===-1){this.oButtonCollapsed.removeAllAssociation("ariaLabelledBy");!a&&this.oButtonCollapsed.addAriaLabelledBy(e)}};p.prototype._getLabellingElementId=function(){var e=this.getHeaderToolbar(),t=this.getHeaderText(),a=null;if(e){a=e.getTitleId()}else if(t){a=this.getId()+"-header"}return a};return p});