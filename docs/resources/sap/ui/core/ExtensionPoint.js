/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/base/util/ObjectPath","sap/ui/core/mvc/View"],function(e,n,i){"use strict";sap.ui.extensionpoint=function(n,i,a,o,r){e.warning("Do not use deprecated factory function 'sap.ui.extensionpoint'. Use 'sap.ui.core.ExtensionPoint.load' instead","sap.ui.extensionpoint",null,function(){return{type:"sap.ui.extensionpoint",name:i}});return t._factory(n,i,a,o,r)};var t=sap.ui.extensionpoint;t._factory=function(i,a,o,r,s){var u,f,c;var g=sap.ui.require("sap/ui/core/CustomizingConfiguration"),m=sap.ui.require("sap/ui/core/mvc/View"),l=sap.ui.require("sap/ui/core/Fragment");if(m&&i instanceof m){u=g&&g.getViewExtension(i.sViewName,a,i);f=i}else if(l&&i instanceof l){u=g&&g.getViewExtension(i.getFragmentName(),a,i);f=i._oContainingView}if(g){if(u){if(u.className){var d=sap.ui.requireSync(u.className.replace(/\./g,"/"));d=d||n.get(u.className);var p=f&&u.id?f.createId(u.id):u.id;e.info("Customizing: View extension found for extension point '"+a+"' in View '"+f.sViewName+"': "+u.className+": "+(u.viewName||u.fragmentName));if(u.className==="sap.ui.core.Fragment"){var w=new d({id:p,type:u.type,fragmentName:u.fragmentName,containingView:f});c=Array.isArray(w)?w:[w]}else if(u.className==="sap.ui.core.mvc.View"){var f=m._legacyCreate({type:u.type,viewName:u.viewName,id:p});c=[f]}else{e.warning("Customizing: Unknown extension className configured (and ignored) in Component.js for extension point '"+a+"' in View '"+f.sViewName+"': "+u.className)}}else{e.warning("Customizing: no extension className configured in Component.js for extension point '"+a+"' in View '"+f.sViewName+"': "+u.className)}}}else if(t._sExtensionProvider){return[{view:f,name:a,createDefault:o,targetControl:undefined,aggregationName:undefined,index:undefined,ready:function(e){var n=this._nextSibling;while(n!=null){n.index+=e.length;n=n._nextSibling}},_isExtensionPoint:true,_nextSibling:null}]}if(!c&&typeof o==="function"){c=o()}var x=function(n){if(n&&!Array.isArray(n)){n=[n]}if(n&&r){var i=r.getMetadata().getAggregation(s);if(i){for(var t=0,o=n.length;t<o;t++){r[i._sMutator](n[t])}}else{e.error("Creating extension point failed - Tried to add extension point with name "+a+" to an aggregation of "+r.getId()+" in view "+f.sViewName+", but sAggregationName was not provided correctly and I could not find a default aggregation")}}return n||[]};if(c&&typeof c.then==="function"){return c.then(x)}else{return x(c)}};t.registerExtensionProvider=function(e){t._sExtensionProvider=e};t.load=function(e){return Promise.resolve(t._factory(e.container,e.name,e.createDefaultContent))};return t});