/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/ManagedObject","sap/ui/base/ManagedObjectMetadata","sap/base/util/ObjectPath","sap/ui/util/XMLHelper","sap/base/util/isPlainObject","sap/base/Log"],function(t,e,n,r,i,o){"use strict";return{bySelector:function(t,e,n){var r;if(t&&t.name){var i=this.getExtensionPointInfo(t.name,n);return i?i.parent:undefined}r=this.getControlIdBySelector(t,e);return this._byId(r,n)},getControlIdBySelector:function(t,e){if(!t){return undefined}if(typeof t==="string"){t={id:t}}var n=t.id;if(t.idIsLocal){if(e){n=e.createId(n)}else{throw new Error("App Component instance needed to get a control's ID from selector")}}else{var r=/^application-[^-]*-[^-]*-component---/gim;var i=!!r.exec(t.id);if(i){n=n.replace(/^application-[^-]*-[^-]*-component---/g,"");if(e){n=e.createId(n)}else{throw new Error("App Component instance needed to get a control's ID from selector")}}}return n},getSelector:function(t,e,n){var r=t;if(typeof r!=="string"){r=t?this.getId(t):undefined}else if(!e){throw new Error("App Component instance needed to get a selector from string ID")}if(n&&(n.id||n.idIsLocal)){throw new Error("A selector of control with the ID '"+r+"' was requested, "+"but core properties were overwritten by the additionally passed information.")}var i=this.checkControlId(r,e);if(!i){throw new Error("Generated ID attribute found - to offer flexibility a stable control ID is needed to assign the changes to, but for this control the ID was generated by SAPUI5 "+r)}var o=Object.assign({},n,{id:"",idIsLocal:false});if(this.hasLocalIdSuffix(r,e)){var a=e.getLocalId(r);o.id=a;o.idIsLocal=true}else{o.id=r}return o},checkControlId:function(n,r){var i=n instanceof t?n.getId():n;var o=e.isGeneratedId(i);return!o||this.hasLocalIdSuffix(n,r)},hasLocalIdSuffix:function(e,n){var r=e instanceof t?e.getId():e;if(!n){o.error("Determination of a local ID suffix failed due to missing app component for "+r);return false}return!!n.getLocalId(r)},_checkAndPrefixIdsInFragment:function(t,e){var n=r.getParseError(t);if(n.errorCode!==0){throw new Error(t.parseError.reason)}var i=t.documentElement;var o=[],a=[];if(i.localName==="FragmentDefinition"){o=this._getElementNodeChildren(i)}else{o=[i]}a=[].concat(o);function s(t){a.push(t)}for(var c=0,f=o.length;c<f;c++){this._traverseXmlTree(s,o[c])}for(var u=0,g=a.length;u<g;u++){if(a[u].getAttribute("id")){a[u].setAttribute("id",e+"."+a[u].getAttribute("id"))}else{throw new Error("At least one control does not have a stable ID")}}return i},_getElementNodeChildren:function(t){var e=[];var n=t.childNodes;for(var r=0,i=n.length;r<i;r++){if(n[r].nodeType===1){e.push(n[r])}}return e},_isInstanceOf:function(t,e){var r=n.get(e);if(typeof r==="function"){return t instanceof r}else{return false}},_hasInterface:function(t,e){var n=t.getMetadata().getInterfaces();return n.indexOf(e)!==-1},_getControlMetadataInXml:function(t){var e=this._getControlTypeInXml(t);jQuery.sap.require(e);var r=n.get(e);return r.getMetadata()},getControlMetadata:function(t){},getLibraryName:function(t){var e=this.getControlMetadata(t);return e.getLibraryName()},_getControlTypeInXml:function(t){var e=t.namespaceURI;e=e?e+".":"";e+=t.localName;return e},_traverseXmlTree:function(t,e){function n(e,r,i){var o;if(!i){var a=this._getControlMetadataInXml(r);o=a.getAllAggregations()}var s=this._getElementNodeChildren(r);s.forEach(function(e){var i=o&&o[e.localName];n.call(this,r,e,i);if(!i){t(e)}}.bind(this))}n.call(this,e,e,false)},_getSerializedValue:function(t){if(this._isSerializable(t)&&typeof t!=="string"){return JSON.stringify(t)}return t},_isSerializable:function(t){return i(t)||Array.isArray(t)||Object(t)!==t},getPropertyBindingOrProperty:function(t,e){return this.getPropertyBinding(t,e)||this.getProperty(t,e)},setPropertyBindingOrProperty:function(t,e,n){var r=n&&(n.path||n.parts);var i=n&&typeof n==="string"&&n.substring(0,1)==="{"&&n.slice(-1)==="}";var o=r||i?"setPropertyBinding":"setProperty";this[o](t,e,n)},setVisible:function(t,e){},getVisible:function(t){},setStashed:function(t,e){},getStashed:function(t){},bindProperty:function(t,e,n){},unbindProperty:function(t,e){},bindAggregation:function(t,e,n){},unbindAggregation:function(t,e){},setProperty:function(t,e,n){},getProperty:function(t,e){},isPropertyInitial:function(t,e){},setPropertyBinding:function(t,e,n){},getPropertyBinding:function(t,e){},createControl:function(t,e,n,r,i,o){},applySettings:function(t,e){},_byId:function(t,e){},getId:function(t){},getParent:function(t){},getControlType:function(t){},setAssociation:function(t,e,n){},getAssociation:function(t,e){},getAllAggregations:function(t){},getAggregation:function(t,e){},insertAggregation:function(t,e,n,r,i){},removeAggregation:function(t,e,n){},removeAllAggregation:function(t,e){},getBindingTemplate:function(t,e){},updateAggregation:function(t,e){},findIndexInParentAggregation:function(t){},getParentAggregationName:function(t,e){},validateType:function(t,e,n,r,i){},instantiateFragment:function(t,e,n){},destroy:function(t){},getChangeHandlerModulePath:function(t){},attachEvent:function(t,e,n,r){},detachEvent:function(t,e,n){},getExtensionPointInfo:function(t,e){}}});