/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/ValueStateSupport","./MenuItemBase","./library","sap/ui/core/library","sap/ui/Device","sap/base/Log","sap/ui/events/PseudoEvents","sap/ui/dom/jquery/cursorPos"],function(t,e,s,a,i,o,n){"use strict";var r=a.ValueState;var p=e.extend("sap.ui.unified.MenuTextFieldItem",{metadata:{library:"sap.ui.unified",properties:{label:{type:"string",group:"Appearance",defaultValue:null},icon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},value:{type:"string",group:"Misc",defaultValue:null},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:r.None}}}});(function(){p.prototype.render=function(t,e,s,a){var i=t,o=s.checkEnabled(e),n=e.getId();i.openStart("li",e);i.class("sapUiMnuItm").class("sapUiMnuTfItm");if(a.iItemNo==1){i.class("sapUiMnuItmFirst")}else if(a.iItemNo==a.iTotalItems){i.class("sapUiMnuItmLast")}if(!s.checkEnabled(e)){i.class("sapUiMnuItmDsbl")}if(e.getStartsSection()){i.class("sapUiMnuItmSepBefore")}if(!o){i.attr("disabled","disabled")}if(a.bAccessible){i.attr("role","menuitem");i.attr("aria-posinset",a.iItemNo);i.attr("aria-setsize",a.iTotalItems)}i.openEnd();i.openStart("div").class("sapUiMnuItmL").openEnd().close("div");i.openStart("div").class("sapUiMnuItmIco").openEnd();if(e.getIcon()){i.icon(e.getIcon(),null,{title:null})}i.close("div");i.openStart("div",n+"-txt").class("sapUiMnuItmTxt").openEnd();i.openStart("label",n+"-lbl").class("sapUiMnuTfItemLbl").openEnd();i.text(e.getLabel());i.close("label");i.openStart("div",n+"-str").class("sapUiMnuTfItmStretch").openEnd().close("div");i.openStart("div").class("sapUiMnuTfItemWrppr").openEnd();i.voidStart("input",n+"-tf").attr("tabindex","-1");i.attr("value",e.getValue());i.class("sapUiMnuTfItemTf").class(o?"sapUiMnuTfItemTfEnbl":"sapUiMnuTfItemTfDsbl");if(!o){i.attr("disabled","disabled")}if(a.bAccessible){i.accessibilityState(e,{role:"textbox",disabled:null,multiline:false,autocomplete:"none",labelledby:{value:n+"-lbl",append:true}})}i.voidEnd().close("div").close("div");i.openStart("div").class("sapUiMnuItmR").openEnd().close("div");i.close("li")};p.prototype.hover=function(t,e){this.$().toggleClass("sapUiMnuItmHov",t);if(t&&e.checkEnabled(this)){e.closeSubmenu(false,true)}};p.prototype.focus=function(t){if(this.getEnabled()&&this.getVisible()){this.$("tf").get(0).focus()}else{t.focus()}};p.prototype.onAfterRendering=function(){this._adaptSizes();this.setValueState(this.getValueState())};p.prototype.onsapup=function(t){this.getParent().onsapprevious(t)};p.prototype.onsapdown=function(t){this.getParent().onsapnext(t)};p.prototype.onsaphome=function(t){if(this._checkCursorPosForNav(false)){this.getParent().onsaphome(t)}};p.prototype.onsapend=function(t){if(this._checkCursorPosForNav(true)){this.getParent().onsapend(t)}};p.prototype.onsappageup=function(t){this.getParent().onsappageup(t)};p.prototype.onsappagedown=function(t){this.getParent().onsappagedown(t)};p.prototype.onsapescape=function(t){this.getParent().onsapescape(t)};p.prototype.onkeydown=function(t){t.stopPropagation()};p.prototype.onclick=function(t){this.getParent().closeSubmenu(false,true);if(!i.system.desktop&&this.getParent().checkEnabled(this)){this.focus()}t.stopPropagation()};p.prototype.onkeyup=function(t){if(!n.events.sapenter.fnCheck(t)&&t.key!=="Enter"){return}var e=this.$("tf").val();this.setValue(e);this.getParent().selectItem(this);t.preventDefault();t.stopPropagation()};p.prototype.setSubmenu=function(t){o.warning("The aggregation 'submenu' is not supported for this type of menu item.","","sap.ui.unified.MenuTextFieldItem");return this};p.prototype.setLabel=function(t){this.setProperty("label",t,true);this.$("lbl").text(t);this._adaptSizes();return this};p.prototype.setValue=function(t){this.setProperty("value",t,true);this.$("tf").val(t);return this};p.prototype.setValueState=function(e){this.setProperty("valueState",e,true);var s=this.$("tf");s.toggleClass("sapUiMnuTfItemTfErr",e==r.Error);s.toggleClass("sapUiMnuTfItemTfWarn",e==r.Warning);var a=t.enrichTooltip(this,this.getTooltip_AsString());this.$().attr("title",a?a:"");return this};p.prototype.getFocusDomRef=function(){var t=this.$("tf");return t.length?t.get(0):null};p.prototype._adaptSizes=function(){var t=this.$("tf");var e=this.$("lbl");var s=e.length?e.get(0).offsetLeft:0;if(sap.ui.getCore().getConfiguration().getRTL()){t.parent().css({width:"auto",right:this.$().outerWidth(true)-s+(e.outerWidth(true)-e.outerWidth())+"px"})}else{t.parent().css({width:"auto",left:s+e.outerWidth(true)+"px"})}};p.prototype._checkCursorPosForNav=function(t){var e=sap.ui.getCore().getConfiguration().getRTL();var s=t?e:!e;var a=this.$("tf");var i=a.cursorPos();var o=a.val().length;if(e){i=o-i}if(!s&&i!=o||s&&i!=0){return false}return true}})();return p});