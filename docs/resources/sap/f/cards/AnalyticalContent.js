/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/f/library","sap/f/cards/BaseContent","sap/f/cards/BindingResolver","sap/viz/ui5/controls/VizFrame","sap/viz/ui5/controls/common/feeds/FeedItem","sap/viz/ui5/data/FlattenedDataset","sap/base/Log","sap/ui/core/Core","jquery.sap.global"],function(e,t,i,a,r,n,o,s,l){"use strict";var p={Top:"top",Bottom:"bottom",Left:"left",Right:"right"};var u={TopLeft:"topLeft",Center:"center"};var d={Left:"left",Center:"center",Right:"right"};var g={Line:"line",StackedColumn:"stacked_column",StackedBar:"stacked_bar",Donut:"donut"};var v=e.cards.AreaType;var f=t.extend("sap.f.cards.AnalyticalContent",{renderer:{}});f.prototype._getVizPropertiesObject=function(e){var t=e.title,i=e.legend,a=e.plotArea;if(!e){return this}var r={title:{style:{fontWeight:"normal"},layout:{respectPlotPosition:false}},legend:{},legendGroup:{layout:{}},plotArea:{window:{start:"firstDataPoint",end:"lastDataPoint"}},categoryAxis:{title:{}},valueAxis:{title:{}},interaction:{noninteractiveMode:true}};if(t){r.title.text=t.text;r.title.visible=t.visible;r.title.alignment=d[t.alignment]}if(i){r.legend.visible=i.visible;r.legendGroup.layout.position=p[i.position];r.legendGroup.layout.alignment=u[i.alignment]}if(a){if(a.dataLabel){r.plotArea.dataLabel=a.dataLabel}if(a.categoryAxisText){r.categoryAxis.title.visible=a.categoryAxisText.visible}if(a.valueAxisText){r.valueAxis.title.visible=a.valueAxisText.visible}}return r};f.prototype._updateModel=function(){t.prototype._updateModel.apply(this,arguments);this._createChart()};f.prototype._createChart=function(){var e=this.getConfiguration();if(!e.chartType){o.error("ChartType is a mandatory property");return}var t=i.resolveValue(e,this.getModel(),"/");var s=[];if(e.dimensions){var l=[];for(var p=0;p<e.dimensions.length;p++){var u=e.dimensions[p];var d=t.dimensions[p].label;s.push(d);var f={name:d,value:u.value};l.push(f)}}var c=[];if(e.measures){var h=[];for(var p=0;p<e.measures.length;p++){var y=e.measures[p];var d=t.measures[p].label;c.push(d);var m={name:d,value:y.value};h.push(m)}}var b=new n({measures:h,dimensions:l,data:{path:this.getBindingContext().getPath()}});var A=new a({uiConfig:{applicationSet:"fiori"},height:"100%",width:"100%",vizType:g[e.chartType],dataset:b,legendVisible:e.legend,feeds:[new r({uid:e.measureAxis,type:"Measure",values:c}),new r({uid:e.dimensionAxis,type:"Dimension",values:s})]});var x=this._getVizPropertiesObject(t);A.setVizProperties(x);this._oActions.setAreaType(v.Content);this._oActions.attach(e,this);this.setAggregation("_content",A)};f.prototype.onBeforeRendering=function(){if(this._handleHostConfiguration){this._handleHostConfiguration()}};f.prototype._handleHostConfiguration=function(){var e=this.getParent(),t=this.getAggregation("_content");if(e&&e.getHostConfigurationId&&t){var i=s.byId(e.getHostConfigurationId());if(i){var a=i.generateJSONSettings("vizProperties"),r=t.getVizProperties();r=l.extend(true,r,a);t.setVizProperties(r)}}};return f});